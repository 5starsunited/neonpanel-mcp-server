{
  "name": "brand_analytics_get_cross_sell_opportunities",
  "description": "Retrieves products frequently purchased together from Amazon Brand Analytics Market Basket Analysis report.\n\nUse this tool to:\n- Discover complementary products for Virtual Bundle creation\n- Identify A+ Content cross-sell table candidates\n- Find Product Targeting ad campaign opportunities (target ASINs frequently co-purchased with yours)\n- Detect competitor products commonly bought alongside yours (defensive/offensive targeting)\n- Validate bundle ideas with real co-purchase data\n\nData source: Weekly Market Basket report. Each primary ASIN has up to 3 co-purchased ASINs per week.\n- combination_pct: Percentage of the primary ASIN's orders that also included the co-purchased ASIN (0-100 scale)\n- best_rank: Amazon's co-purchase rank (1 = most frequently bought together)\n- consistency_score: How reliably this pair appears across weeks (1.0 = every week in the window)\n\nOwnership detection: co_purchased_is_own = true when the co-purchased ASIN also appears as a primary ASIN (i.e., it belongs to the seller). Use this to distinguish own-portfolio cross-sell from competitor product insights.\n\nIMPORTANT: Results are capped by the 'limit' parameter (default 50). When 'asin' filter is omitted, ALL ASINs are considered but only the top N pairs by sort order are returned. A seller may have hundreds of ASIN pairs. To explore different segments: (1) filter by specific ASINs, (2) adjust sort field, or (3) increase limit up to 200.\n\nDefault time window: Last 4 complete weeks. Use periods_back or explicit start_date/end_date for custom ranges.\n\nTip: Filter to max_rank=1 to see only the #1 co-purchased product per ASIN. Raise min_combination_pct to focus on strong signals.\n\nIntegration note: Cross-reference with advertising_analyze_search_terms to validate co-purchase patterns with paid traffic behaviour. Use brand_analytics_get_keyword_funnel_metrics to check if co-purchased ASINs share keywords.\n\nKnowledge base: https://help.neonpanel.com/en/articles/brand-analytics-market-basket",
  "isConsequential": false,
  "inputSchema": {
    "type": "object",
    "properties": {
      "query": {
        "type": "object",
        "description": "Query envelope for Market Basket cross-sell analysis.",
        "properties": {
          "filters": {
            "type": "object",
            "description": "Filters for cross-sell analysis. company_id is required; all others are optional.",
            "properties": {
              "company_id": {
                "type": "integer",
                "minimum": 1,
                "description": "Numeric company identifier. Required."
              },
              "asin": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "maxItems": 20,
                "description": "Primary ASINs to find co-purchased products for. Omit to return all ASINs."
              },
              "marketplace": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "minItems": 1,
                "maxItems": 1,
                "description": "Amazon marketplace code (e.g., 'US', 'UK', 'DE'). Omit for all marketplaces."
              }
            },
            "required": [
              "company_id"
            ],
            "additionalProperties": false
          },
          "aggregation": {
            "type": "object",
            "properties": {
              "time": {
                "type": "object",
                "properties": {
                  "start_date": {
                    "type": "string",
                    "format": "date",
                    "description": "Start of analysis window (inclusive), format YYYY-MM-DD. If omitted, derived from periods_back."
                  },
                  "end_date": {
                    "type": "string",
                    "format": "date",
                    "description": "End of analysis window (inclusive), format YYYY-MM-DD. If omitted, uses latest available data."
                  },
                  "periods_back": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 52,
                    "default": 4,
                    "description": "Number of weeks to look back from latest data (default 4)."
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          "sort": {
            "type": "object",
            "description": "Controls ranking and ordering of results. Rows are returned with a 'rank' column (1 = best).",
            "properties": {
              "field": {
                "type": "string",
                "enum": [
                  "avg_combination_pct",
                  "max_combination_pct",
                  "best_rank",
                  "weeks_appearing",
                  "consistency_score",
                  "primary_asin",
                  "co_purchased_asin",
                  "last_seen"
                ],
                "default": "avg_combination_pct",
                "description": "Column to sort and rank by. Default: avg_combination_pct DESC (strongest co-purchase signal first). Use consistency_score DESC to find most reliable pairs. Use best_rank ASC to see #1 co-purchased products first."
              },
              "direction": {
                "type": "string",
                "enum": [
                  "asc",
                  "desc"
                ],
                "default": "desc",
                "description": "Sort direction. DESC for highest-first (strongest signals). ASC for lowest-first (e.g., best_rank ASC = top-ranked pairs first)."
              }
            },
            "additionalProperties": false
          },
          "select_fields": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Optional output field selection. When provided, only these fields are returned per row â€” reduces response size."
          },
          "limit": {
            "type": "integer",
            "minimum": 1,
            "maximum": 200,
            "default": 50,
            "description": "Maximum rows to return (default 50, max 200). Only the top N pairs by the chosen sort order are returned."
          }
        },
        "required": [
          "filters"
        ],
        "additionalProperties": false
      },
      "tool_specific": {
        "type": "object",
        "description": "Cross-sell analysis thresholds.",
        "properties": {
          "min_combination_pct": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "default": 0,
            "description": "Minimum average combination percentage to include (0-100). E.g., 0.5 = at least 0.5% co-purchase rate."
          },
          "max_rank": {
            "type": "integer",
            "minimum": 1,
            "maximum": 3,
            "default": 3,
            "description": "Max co-purchase rank to include (1-3). Set to 1 to see only the #1 co-purchased product per ASIN."
          }
        },
        "additionalProperties": false
      }
    },
    "required": [
      "query"
    ],
    "additionalProperties": false
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "items": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "rank": {
              "type": "integer",
              "description": "1-based position according to sort field and direction."
            },
            "primary_asin": {
              "type": "string",
              "description": "The seller's own ASIN."
            },
            "primary_product_family": {
              "type": "string",
              "description": "Product family of the primary ASIN (e.g., 'Widgets 3-Pack'). 'unknown' if not mapped."
            },
            "primary_brand": {
              "type": "string",
              "description": "Brand name of the primary ASIN. 'unknown' if not mapped."
            },
            "primary_pareto_abc_class": {
              "type": "string",
              "description": "Pareto ABC class of the primary ASIN (A/B/C). 'unknown' if not mapped."
            },
            "primary_revenue_abcd_class": {
              "type": "string",
              "description": "Revenue ABCD class of the primary ASIN (A/B/C/D). 'unknown' if not mapped."
            },
            "primary_revenue_share": {
              "type": "number",
              "description": "Revenue share of the primary ASIN within the company's portfolio (0-1 scale). null if not mapped."
            },
            "co_purchased_asin": {
              "type": "string",
              "description": "ASIN frequently bought together with primary_asin."
            },
            "co_purchased_product_family": {
              "type": "string",
              "description": "Product family of the co-purchased ASIN. 'unknown' if not mapped (often for competitor ASINs)."
            },
            "co_purchased_brand": {
              "type": "string",
              "description": "Brand name of the co-purchased ASIN. 'unknown' if not mapped."
            },
            "co_purchased_pareto_abc_class": {
              "type": "string",
              "description": "Pareto ABC class of the co-purchased ASIN. 'unknown' if not mapped."
            },
            "co_purchased_revenue_abcd_class": {
              "type": "string",
              "description": "Revenue ABCD class of the co-purchased ASIN. 'unknown' if not mapped."
            },
            "co_purchased_revenue_share": {
              "type": "number",
              "description": "Revenue share of the co-purchased ASIN. null if not mapped."
            },
            "marketplace": {
              "type": "string",
              "description": "Marketplace country code (e.g., US, DE)."
            },
            "best_rank": {
              "type": "integer",
              "description": "Best (lowest) co-purchase rank observed (1=top)."
            },
            "avg_combination_pct": {
              "type": "number",
              "description": "Average combination pct across weeks in the window."
            },
            "max_combination_pct": {
              "type": "number",
              "description": "Highest combination pct observed in any single week."
            },
            "min_combination_pct": {
              "type": "number",
              "description": "Lowest combination pct observed in any single week."
            },
            "weeks_appearing": {
              "type": "integer",
              "description": "Number of weeks this pair appeared in the data."
            },
            "total_weeks": {
              "type": "integer",
              "description": "Total weeks in the analysis window."
            },
            "consistency_score": {
              "type": "number",
              "description": "weeks_appearing / total_weeks (1.0 = every week)."
            },
            "co_purchased_is_own": {
              "type": "boolean",
              "description": "True if co-purchased ASIN also belongs to the seller (appears as a primary ASIN)."
            },
            "first_seen": {
              "type": "string",
              "format": "date",
              "description": "First week this pair appeared."
            },
            "last_seen": {
              "type": "string",
              "format": "date",
              "description": "Last week this pair appeared."
            },
            "window_start": {
              "type": "string",
              "format": "date",
              "description": "Start of the analysis window."
            },
            "window_end": {
              "type": "string",
              "format": "date",
              "description": "End of the analysis window."
            }
          },
          "additionalProperties": true
        }
      }
    },
    "required": [
      "items"
    ]
  },
  "examples": [
    {
      "title": "Top co-purchased pairs for a company",
      "description": "Which product pairs are most frequently bought together?",
      "request": {
        "query": {
          "filters": {
            "company_id": 42,
            "marketplace": [
              "US"
            ]
          },
          "sort": {
            "field": "avg_combination_pct",
            "direction": "desc"
          },
          "limit": 30
        }
      }
    },
    {
      "title": "Only #1 co-purchased product per ASIN",
      "description": "Show the single strongest cross-sell partner for each ASIN.",
      "request": {
        "query": {
          "filters": {
            "company_id": 42,
            "marketplace": [
              "US"
            ]
          },
          "sort": {
            "field": "avg_combination_pct",
            "direction": "desc"
          }
        },
        "tool_specific": {
          "max_rank": 1
        }
      }
    },
    {
      "title": "Cross-sell pairs for specific ASINs",
      "description": "What products are frequently bought together with these ASINs?",
      "request": {
        "query": {
          "filters": {
            "company_id": 42,
            "asin": [
              "B0ABC12345",
              "B0DEF67890"
            ],
            "marketplace": [
              "US"
            ]
          },
          "sort": {
            "field": "avg_combination_pct",
            "direction": "desc"
          }
        }
      }
    },
    {
      "title": "Strong signals only (high combination %)",
      "description": "Filter to pairs with at least 2% co-purchase rate for bundle validation.",
      "request": {
        "query": {
          "filters": {
            "company_id": 42,
            "marketplace": [
              "US"
            ]
          },
          "sort": {
            "field": "avg_combination_pct",
            "direction": "desc"
          }
        },
        "tool_specific": {
          "min_combination_pct": 2
        }
      }
    },
    {
      "title": "Most consistent cross-sell pairs over 12 weeks",
      "description": "Which pairs appear every single week? High consistency = reliable bundle opportunity.",
      "request": {
        "query": {
          "filters": {
            "company_id": 42,
            "marketplace": [
              "US"
            ]
          },
          "aggregation": {
            "time": {
              "periods_back": 12
            }
          },
          "sort": {
            "field": "consistency_score",
            "direction": "desc"
          },
          "limit": 20
        }
      }
    },
    {
      "title": "Competitor products frequently bought with mine",
      "description": "Find competitor ASINs that customers buy alongside your products (co_purchased_is_own = false).",
      "request": {
        "query": {
          "filters": {
            "company_id": 42,
            "marketplace": [
              "US"
            ]
          },
          "sort": {
            "field": "avg_combination_pct",
            "direction": "desc"
          },
          "limit": 50
        },
        "tool_specific": {
          "max_rank": 1
        }
      }
    }
  ]
}