CREATE TABLE brand_analytics_iceberg.search_query_performance_snapshot (
  company string,
  marketplace string,
  marketplace_country_code string,
  parent_asin string,
  revenue_abcd_class string,
  pareto_abc_class string,
  brand string,
  revenue_share double,
  title string,
  date string,
  rspec_marketplaceids array<string>,
  asin string,
  cartadddata_asincartaddcount double,
  cartadddata_asincartaddshare double,
  cartadddata_asinmediancartaddprice_amount double,
  cartadddata_asinmediancartaddprice_currencycode string,
  cartadddata_totalcartaddcount double,
  cartadddata_totalcartaddrate double,
  cartadddata_totalmediancartaddprice_amount double,
  cartadddata_totalmediancartaddprice_currencycode string,
  cartadddata_totalonedayshippingcartaddcount double,
  cartadddata_totalsamedayshippingcartaddcount double,
  cartadddata_totaltwodayshippingcartaddcount double,
  clickdata_asinclickcount double,
  clickdata_asinclickshare double,
  clickdata_asinmedianclickprice_amount double,
  clickdata_asinmedianclickprice_currencycode string,
  clickdata_totalclickcount double,
  clickdata_totalclickrate double,
  clickdata_totalmedianclickprice_amount double,
  clickdata_totalmedianclickprice_currencycode string,
  clickdata_totalonedayshippingclickcount double,
  clickdata_totalsamedayshippingclickcount double,
  clickdata_totaltwodayshippingclickcount double,
  enddate timestamp,
  impressiondata_asinimpressioncount double,
  impressiondata_asinimpressionshare double,
  impressiondata_totalqueryimpressioncount double,
  purchasedata_asinmedianpurchaseprice_amount double,
  purchasedata_asinmedianpurchaseprice_currencycode string,
  purchasedata_asinpurchasecount double,
  purchasedata_asinpurchaseshare double,
  purchasedata_totalmedianpurchaseprice_amount double,
  purchasedata_totalmedianpurchaseprice_currencycode string,
  purchasedata_totalonedayshippingpurchasecount double,
  purchasedata_totalpurchasecount double,
  purchasedata_totalpurchaserate double,
  purchasedata_totalsamedayshippingpurchasecount double,
  purchasedata_totaltwodayshippingpurchasecount double,
  searchquerydata_searchquery string,
  searchquerydata_searchqueryscore double,
  searchquerydata_searchqueryvolume double,
  startdate timestamp,
  ingest_ts_utc timestamp,
  company_id string,
  amazon_seller_id string,
  week_start date,
  year int,
  kpi_impression_share double,
  kpi_click_share double,
  kpi_cart_add_rate double,
  kpi_purchase_rate double,
  kpi_ctr_advantage double,
  row_type string,
  kpi_impression_share_wow double,
  kpi_impression_share_wolast4 double,
  kpi_impression_share_wolast12 double,
  kpi_click_share_wow double,
  kpi_click_share_wolast4 double,
  kpi_click_share_wolast12 double,
  kpi_cart_add_rate_wow double,
  kpi_cart_add_rate_wolast4 double,
  kpi_cart_add_rate_wolast12 double,
  kpi_purchase_rate_wow double,
  kpi_purchase_rate_wolast4 double,
  kpi_purchase_rate_wolast12 double,
  kpi_ctr_advantage_wow double,
  kpi_ctr_advantage_wolast4 double,
  kpi_ctr_advantage_wolast12 double,
  product_family string)
PARTITIONED BY (`company_id`, `year`, `week_start`)
LOCATION 's3://etl-glue-amazon-ads-prod-preprocessbucketreports6-1w0usrm0kq0j7/aws_etl/brand_analytics_iceberg/brand_analytics_iceberg/search_query_performance_snapshot'
TBLPROPERTIES (
  'table_type'='iceberg',
  'compression_level'='3',
  'format'='PARQUET',
  'write_compression'='ZSTD'
);